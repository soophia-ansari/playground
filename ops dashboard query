select * from (select mvd.org_id,
mvd.org_level_category_cd,
mvd.patient_medicare_group_cd,
mvd.period_id,
mvd.org_group_id,
mvd.org_group_id as org_group_id_filter,
mvd.measure_name,
mvd.measure_cd,
mvd.measure_value_text,
mvd.measure_value_decimal,
mvd.measure_value_date,
mvd.component_1_value_text,
mvd.component_1_value_decimal,
mvd.component_1_value_date,
mvd.component_2_value_text,
mvd.component_2_value_decimal,
mvd.component_2_value_date,
mvd.component_3_value_text,
mvd.component_3_value_decimal,
mvd.component_3_value_date,
mvd.component_4_value_text,
mvd.component_4_value_decimal,
mvd.component_4_value_date,
mvd.component_expenditure_category,
mvd.measure_label,
mvd.period_type,
mvd.number_format,
mvd.measure_definition,
mvd.provider_name,
mvd.at_time_tin_id,
case when mvd.org_level_category_cd = 'at_time_tin' then coalesce(mvd.tin_name,mvd.org_group_id) else mvd.tin_name end as tin_name,
mvd.at_time_network_id,
mvd.network_name,
mvd.measure_value_string_format,
case when mvd.org_level_category_cd = 'at_time_tin' then coalesce(mvd.org_group_name,mvd.org_group_id) else mvd.org_group_name end as org_group_name,
mvd.month_short_label,
mvd.month_start_dt,
mvd.load_period,
mvd.load_run_id,
mvd.load_ts,
mvd.benchmark_value,
mvd.benchmark_upper_threshold,
mvd.benchmark_lower_threshold,
mvd.benchmark_src_cd,
mvd.attribution_type
from insights.metric_value_operational_dashboard mvd
where org_level_category_cd = <Parameters.org_level_category_cd>
and patient_medicare_group_cd = <Parameters.patient_medicare_group_cd>
and attribution_type = <Parameters.Attribution Type>) a
where a.org_group_name is not null